Turbo Assembler	 Version 4.1	    02/25/20 17:59:19	    Page 1
framesou.asm



      1				     .186
      2	0000			     .model tiny
      3
      4				     ;=================================================
      5
      6	      =05DB		     rShadow = 05dbh
      7	      =05DF		     bShadow = 05dfh
      8
      9	      =06C9		     tlCon   = 06c9h	     ;top left connor
     10	      =06BB		     trCon   = 06bbh	     ;top right	connor
     11	      =06C8		     blCon   = 06c8h	     ;bottom left connor
     12	      =06BC		     brCon   = 06bch	     ;bottom right connor
     13
     14	      =06CD		     horiz   = 06cdh	     ;horiz line
     15	      =06BA		     vertic  = 06bah	     ;vertic line
     16
     17	      =7E00		     fill    = 7e00h	     ;filler symbols
     18
     19				     ;=================================================
     20
     21	0000			     .code
     22				     locals @@
     23				     org 100h
     24
     25				     ;=================================================
     26				     ; Draws a horizontal line
     27				     ; Entry:DI	- address of start
     28				     ;	     CX	- lenght
     29				     ;	     AX	- symb and clr of middle characters
     30				     ;	     BX	- symb and clr of the right character
     31				     ;	     DX	- synb and clr of the left character
     32				     ; Destr:ES, DI, CX
     33				     ;=================================================
     34
     35				     public  horline
     36
     37	0100			     horline proc
     38
     39	0100  68 B800			     push    0b800h
     40	0103  07			     pop     es
     41	0104  26: 89 1D			     mov word ptr es:[di], BX
     42	0107  83 C7 02			     add     di, 2
     43	010A  F3> AB			     rep     stosw
     44	010C  26: 89 15			     mov word ptr es:[di], DX
     45	010F  83 C7 02			     add     di, 2
     46
     47	0112  C3			     ret
     48
     49	0113			     horline endp
     50
     51				     ;=================================================
     52				     ; Draws a shadow for the frame
     53				     ; Entry:DI	- left connor of the frame address
     54				     ;	     CX	- width	of the frame
     55				     ;	     DX	- height of the	frame
     56				     ; Destr: AX, BX, SI, ES
     57				     ;=================================================
Turbo Assembler	 Version 4.1	    02/25/20 17:59:19	    Page 2
framesou.asm



     58
     59				     public  frshad
     60
     61	0113			     frshad  proc
     62
     63	0113  57 51 52			     push    di	cx dx
     64
     65	0116  B8 05DF			     mov     ax, bShadow
     66	0119  BB 05DF			     mov     bx, bShadow
     67	011C  8B F2			     mov     si, dx
     68	011E  BA 05DF			     mov     dx, bShadow
     69
     70	0121  83 C7 02			     add     di, 2
     71	0124  E8 FFD9			     call    horline
     72	0127  81 EF 00A2		     sub     di, 162d
     73	012B  B8 05DB			     mov     ax, rShadow
     74	012E  46			     inc     si
     75
     76	012F			     @@rightSh:
     77
     78	012F  AB			     stosw
     79	0130  81 EF 00A2		     sub     di, 162d
     80	0134  4E			     dec     si
     81	0135  83 FE 01			     cmp     si, 1
     82	0138  73 F5			     jae     @@rightSh
     83
     84	013A  5A 59 5F			     pop     dx	cx di
     85
     86	013D  C3			     ret
     87	013E				     endp
     88
     89				     ;=================================================
     90				     ; Draws a frame
     91				     ; Entry:DI	- left connor address
     92				     ;	     CX	- width
     93				     ;	     DX	- height
     94				     ; Destr: AX, BX, SI, ES
     95				     ;=================================================
     96
     97				     public  framedr
     98
     99	013E			     framedr proc
    100
    101	013E  57			     push    di
    102	013F  51			     push    cx
    103	0140  52			     push    dx
    104
    105	0141  8B F2			     mov     si, dx
    106	0143  51			     push    cx
    107
    108	0144  B8 06CD			     mov     ax, horiz
    109	0147  BB 06C9			     mov     bx, tlCon
    110	014A  BA 06BB			     mov     dx, trCon
    111	014D  E8 FFB0			     call    horline
    112	0150  59			     pop     cx
    113	0151  D1 E1			     shl     cx, 1
    114	0153  2B F9			     sub     di, cx
Turbo Assembler	 Version 4.1	    02/25/20 17:59:19	    Page 3
framesou.asm



    115	0155  D1 E9			     shr     cx, 1
    116	0157  81 C7 009C		     add     di, 156d
    117
    118	015B  56			     push    si
    119
    120	015C  B8 7E00			     mov     ax, fill
    121	015F  BB 06BA			     mov     bx, vertic
    122	0162  BA 06BA			     mov     dx, vertic
    123	0165  51		     @@MID:  push    cx
    124	0166  E8 FF97			     call    horline
    125	0169  59			     pop     cx
    126	016A  D1 E1			     shl     cx, 1
    127	016C  2B F9			     sub     di, cx
    128	016E  81 C7 009C		     add     di, 156d
    129	0172  D1 E9			     shr     cx, 1
    130	0174  4E			     dec     si
    131	0175  83 FE 00			     cmp     si, 0
    132	0178  77 EB			     ja	     @@MID
    133
    134	017A  5E			     pop     si
    135
    136	017B  B8 06CD			     mov     ax, horiz
    137	017E  BB 06C8			     mov     bx, blCon
    138	0181  BA 06BC			     mov     dx, brCon
    139	0184  51			     push    cx
    140	0185  E8 FF78			     call    horline
    141	0188  59			     pop     cx
    142	0189  D1 E1			     shl     cx, 1
    143	018B  2B F9			     sub     di, cx
    144	018D  D1 E9			     shr     cx, 1
    145	018F  8B D6			     mov     dx, si
    146	0191  81 C7 009C		     add     di, 156d
    147	0195  E8 FF7B			     call    frshad
    148
    149	0198  5A			     pop     dx
    150	0199  59			     pop     cx
    151	019A  5F			     pop     di
    152
    153	019B  C3			     ret
    154
    155	019C			     framedr endp
    156
    157				     ;=================================================
    158				     ; Draws an	extending frame
    159				     ; Destr: AX, BX, CX, DX, ES, SI, DI
    160				     ;=================================================
    161
    162				     public frext
    163
    164	019C			     frext   proc
    165
    166	019C  BF 0722			     mov     di, (80*11+33)*2
    167	019F  B9 000C			     mov     cx, 12
    168	01A2  BA 0001			     mov     dx, 1
    169
    170	01A5			     @@DRAW: ;call   framedr
    171	01A5  81 EF 00A6		     sub     di, (80+3)*2
Turbo Assembler	 Version 4.1	    02/25/20 17:59:19	    Page 4
framesou.asm



    172	01A9  83 C1 06			     add     cx, 6
    173	01AC  83 C2 02			     add     dx, 2
    174	01AF  E8 FF8C			     call    framedr
    175	01B2  B4 86			     mov     ah, 86h
    176	01B4  51			     push    cx
    177	01B5  52			     push    dx
    178	01B6  B9 0003			     mov     cx, 3
    179	01B9  BA 0D40			     mov     dx, 0d40h
    180	01BC  CD 15			     int     15h
    181	01BE  5A			     pop     dx
    182	01BF  59			     pop     cx
    183	01C0  81 FF 00A0		     cmp     di, 160
    184	01C4  73 DF			     jae     @@DRAW
    185
    186	01C6  C3			     ret
    187
    188	01C7			     frext   endp
    189
    190				     ;=================================================
    191				     ; Print Line in video memory
    192				     ; Entry:SI	offset of line
    193				     ;	     DI	address	in video memory
    194				     ; Destr:AL, DI
    195				     ;=================================================
    196
    197				     public printl
    198
    199	01C7			     printl  proc
    200
    201	01C7  AC			     lodsb
    202	01C8  AA		     @@NEXT: stosb
    203	01C9  47			     inc di
    204	01CA  AC			     lodsb
    205	01CB  3C 00			     cmp     al, 00
    206	01CD  75 F9			     jne     @@NEXT
    207
    208	01CF  C3			     ret
    209
    210	01D0			     printl  endp
    211
    212
    213				     end
Turbo Assembler	 Version 4.1	    02/25/20 17:59:19	    Page 5
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/25/20"
??FILENAME			  Text	 "framesou"
??TIME				  Text	 "17:59:19"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@DRAW				  Near	 DGROUP:01A5
@@MID				  Near	 DGROUP:0165
@@NEXT				  Near	 DGROUP:01C8
@@RIGHTSH			  Near	 DGROUP:012F
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0103H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 FRAMESOU
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BLCON				  Number 06C8
BRCON				  Number 06BC
BSHADOW				  Number 05DF
FILL				  Number 7E00
FRAMEDR				  Near	 DGROUP:013E
FREXT				  Near	 DGROUP:019C
FRSHAD				  Near	 DGROUP:0113
HORIZ				  Number 06CD
HORLINE				  Near	 DGROUP:0100
PRINTL				  Near	 DGROUP:01C7
RSHADOW				  Number 05DB
TLCON				  Number 06C9
TRCON				  Number 06BB
VERTIC				  Number 06BA

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  01D0 Word	  Public  CODE
