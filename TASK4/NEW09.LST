Turbo Assembler	 Version 4.1	    03/10/20 14:40:20	    Page 1
new09.asm



      1				     .186
      2	0000			     .model tiny
      3	0000			     .code
      4				     org 100h
      5
      6				     locals  @@
      7
      8				     public  Old09
      9				     public  New09
     10
     11				     extrn   al2hex  :proc
     12				     extrn   framedr :proc
     13				     extrn   EndLabel
     14
     15				     ;=================================================
     16				     ; New int 09h that	writes scancode	in hex of the pushed key in frame
     17				     ;=================================================
     18
     19	0100			     New09   proc
     20	0100  50 53 51 52 57 56	06		     push    ax	bx cx dx di si es
     21	0107  B8 B800				     mov     ax, 0b800h
     22	010A  8E C0				     mov     es, ax
     23	010C  BF 053C				     mov     di, (8*80+30)*2
     24	010F  B9 0014				     mov     cx, 20
     25	0112  BA 0005				     mov     dx, 5
     26	0115  E8 0000e				     call    framedr
     27
     28	0118  E4 60				     in	     al, 60h
     29	011A  3C 21				     cmp     al, 21h
     30	011C  75 0C				     jne     @@toHex
     31	011E  BF 03F8				     mov     di, (6*80+28)*2
     32	0121  B9 0018				     mov     cx, 24
     33	0124  BA 0009				     mov     dx, 9
     34	0127  E8 0000e				     call    framedr
     35
     36	012A  E8 0000e		     @@toHex:	     call    Al2Hex
     37	012D  BF 0690				     mov     di, (10*80+40)*2
     38	0130  B4 4E				     mov     ah, 4eh
     39	0132  8A C6				     mov     al, dh
     40	0134  AB				     stosw
     41	0135  8A C2				     mov     al, dl
     42	0137  AB				     stosw
     43
     44	0138  E4 61				     in	     al, 61h
     45	013A  8A E0				     mov     ah, al
     46	013C  0C 80				     or	     al, 80h
     47	013E  E6 61				     out     61h, al
     48	0140  86 C4				     xchg    al, ah
     49	0142  E6 61				     out     61h, al
     50
     51	0144  B0 20				     mov     al, 20h
     52	0146  E6 20				     out     20h, al
     53
     54	0148  07 5E 5F 5A 59 5B	58		     pop     es	si di dx cx bx ax
     55
     56	014F  EA				     db	     0eah
     57	0150  0000		     Old09	     dw	     0
Turbo Assembler	 Version 4.1	    03/10/20 14:40:20	    Page 2
new09.asm



     58	0152  0000				     dw	     0
     59
     60	0154					     endp
     61
     62				     end
Turbo Assembler	 Version 4.1	    03/10/20 14:40:20	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "03/10/20"
??FILENAME			  Text	 "new09	  "
??TIME				  Text	 "14:40:20"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@TOHEX				  Near	 DGROUP:012A
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0103H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 NEW09
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
AL2HEX				  Near	 DGROUP:---- Extern
ENDLABEL			  Word	 DGROUP:---- Extern
FRAMEDR				  Near	 DGROUP:---- Extern
NEW09				  Near	 DGROUP:0100
OLD09				  Word	 DGROUP:0150

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  0154 Word	  Public  CODE
