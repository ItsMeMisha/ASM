Turbo Assembler	 Version 4.1	    03/10/20 17:01:51	    Page 1
new28.asm



      1				     .186
      2	0000			     .model tiny
      3	0000			     .code
      4				     org     100h
      5				     locals @@
      6
      7				     extrn	     BufBeg  :byte
      8				     extrn	     BufEnd  :byte
      9				     extrn	     BUF     :byte
     10				     extrn	     COUNT   :byte
     11				     extrn	     filespec:byte
     12
     13				     public	     Old28
     14				     public	     New28
     15
     16				     ;=================================================
     17				     ; New int 28h prints COUNT	bytes from BUF to filespec and set COUNT to 0
     18				     ;=================================================
     19
     20
     21	0100			     New28	     proc
     22
     23	0100  9C				     pushf
     24	0101  50 52 1E 53 51 57	56+		     push    ax	dx ds bx cx di si es
     25	      06
     26
     27
     28	0109  2E: 8A 0E	0000e			     mov     cl, cs:BufEnd
     29	010E  2E: 2A 0E	0000e			     sub     cl, cs:BufBeg
     30	0113  80 F9 00				     cmp     cl, 0
     31	0116  76 49				     jbe     @@End28
     32
     33	0118  BA 0000e				     mov     dx, offset	cs:filespec
     34	011B  0E				     push    cs
     35	011C  1F				     pop     ds
     36
     37	011D  B8 3D02				     mov     ax, 3d02h
     38	0120  CD 21				     int     21h
     39	0122  8B D8				     mov     bx, ax
     40
     41	0124  73 0A				     jnc     @@cont
     42	0126  8A D0				     mov     dl, al
     43	0128  B8 0200				     mov     ax, 0200h
     44	012B  CD 21				     int     21h
     45	012D  EB 32 90				     jmp     @@End28
     46
     47	0130  B8 4202		     @@cont:	     mov     ax, 4202h
     48	0133  B9 0000				     mov     cx, 0
     49	0136  BA 0000				     mov     dx, 0
     50	0139  CD 21				     int     21h
     51
     52	013B  2E: 8A 0E	0000e			     mov     cl, cs:BufEnd
     53	0140  2E: 2A 0E	0000e			     sub     cl, cs:BufBeg
     54	0145  B5 00				     mov     ch, 00h
     55	0147  BA 0000e				     mov     dx, offset	BUF
     56	014A  2E: 02 16	0000e			     add     dl, cs:BufBeg
     57
Turbo Assembler	 Version 4.1	    03/10/20 17:01:51	    Page 2
new28.asm



     58	014F  B8 4000				     mov     ax, 4000h
     59	0152  CD 21				     int     21h
     60
     61				     ;		     mov     COUNT, 0
     62	0154  2E: A0 0000e			     mov     al, cs:BufEnd
     63	0158  2E: A2 0000e			     mov     cs:BufBeg,	al
     64
     65	015C  B8 3E00				     mov     ax, 3e00h
     66	015F  CD 21				     int     21h
     67
     68	0161  07 5E 5F 59 5B 1F	5A+  @@End28:	     pop     es	si di cx bx ds dx ax
     69	      58
     70
     71				     ;		     mov     al, 20h
     72				     ;		     out     20h, al
     73
     74	0169  9D				     popf
     75	016A  CF				     iret
     76	016B					     endp
     77
     78	016B			     .data
     79
     80	0000  0000		     Old28	     dw	     0
     81	0002  0000				     dw	     0
     82				     end
Turbo Assembler	 Version 4.1	    03/10/20 17:01:51	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "03/10/20"
??FILENAME			  Text	 "new28	  "
??TIME				  Text	 "17:01:51"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@CONT				  Near	 DGROUP:0130
@@END28				  Near	 DGROUP:0161
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0103H
@CURSEG				  Text	 _DATA
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 NEW28
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BUF				  Byte	 DGROUP:---- Extern
BUFBEG				  Byte	 DGROUP:---- Extern
BUFEND				  Byte	 DGROUP:---- Extern
COUNT				  Byte	 DGROUP:---- Extern
FILESPEC			  Byte	 DGROUP:---- Extern
NEW28				  Near	 DGROUP:0100
OLD28				  Word	 DGROUP:0000

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0004 Word	  Public  DATA
  _TEXT				  16  016B Word	  Public  CODE
