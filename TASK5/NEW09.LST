Turbo Assembler	 Version 4.1	    03/10/20 16:56:37	    Page 1
new09.asm



      1				     .186
      2	0000			     .model tiny
      3	0000			     .code
      4				     org     100h
      5
      6
      7				     public	     Old09
      8				     public	     New09
      9
     10				     extrn	     BufBeg  :byte
     11				     extrn	     BufEnd  :byte
     12				     extrn	     BUF     :byte
     13				     extrn	     COUNT   :byte
     14
     15				     ;=================================================
     16				     ; New int 09h that	should read pushed keys	and write them to BUF
     17				     ;=================================================
     18
     19	0100			     New09	     proc
     20
     21	0100  50 1E 57 53 06			     push    ax	ds di bx es
     22
     23	0105  9C				     pushf
     24	0106  FF 1E 0000r			     call    dword ptr [Old09]
     25	010A  9D				     popf
     26
     27	010B  9C				     pushf
     28				     ;		     in	     al, 60h
     29
     30	010C  B8 0000				     mov     ax, 00h
     31	010F  CD 16				     int     16h
     32
     33	0111  2E: 8A 1E	0000e			     mov     bl, cs:BufEnd
     34	0116  B7 00				     mov     bh, 00h
     35	0118  2E: 88 87	0000e			     mov     cs:BUF+bx,	al
     36				     ;		     inc     COUNT
     37	011D  2E: FE 06	0000e			     inc     cs:BufEnd
     38
     39	0122  9D				     popf
     40
     41	0123  07 5B 5F 1F 58			     pop     es	bx di ds ax
     42
     43				     ;		     db	     0eah
     44				     ;Old09	     dw	     0h
     45				     ;		     dw	     0h
     46
     47	0128  E4 61				     in	     al, 61h
     48	012A  8A E0				     mov     ah, al
     49	012C  0C 80				     or	     al, 80h
     50	012E  E6 61				     out     61h, al
     51	0130  86 E0				     xchg    ah, al
     52	0132  E6 61				     out     61h, al
     53
     54	0134  B0 20				     mov     al, 20h
     55	0136  E6 20				     out     20h, al
     56
     57	0138  CF				     iret
Turbo Assembler	 Version 4.1	    03/10/20 16:56:37	    Page 2
new09.asm



     58	0139					     endp
     59
     60	0139			     .data
     61
     62	0000  0000		     Old09	     dw	     0
     63	0002  0000				     dw	     0
     64				     end
Turbo Assembler	 Version 4.1	    03/10/20 16:56:37	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "03/10/20"
??FILENAME			  Text	 "new09	  "
??TIME				  Text	 "16:56:37"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0103H
@CURSEG				  Text	 _DATA
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 NEW09
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BUF				  Byte	 DGROUP:---- Extern
BUFBEG				  Byte	 DGROUP:---- Extern
BUFEND				  Byte	 DGROUP:---- Extern
COUNT				  Byte	 DGROUP:---- Extern
NEW09				  Near	 DGROUP:0100
OLD09				  Word	 DGROUP:0000

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0004 Word	  Public  DATA
  _TEXT				  16  0139 Word	  Public  CODE
