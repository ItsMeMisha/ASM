Turbo Assembler	 Version 4.1	    03/15/20 12:29:57	    Page 1
framesou.asm



      1				     .186
      2	0000			     .model tiny
      3
      4				     ;=================================================
      5
      6	      =05DB		     rShadow = 05dbh
      7	      =05DF		     bShadow = 05dfh
      8
      9	      =06C9		     tlCon   = 06c9h	     ;top left connor
     10	      =06BB		     trCon   = 06bbh	     ;top right	connor
     11	      =06C8		     blCon   = 06c8h	     ;bottom left connor
     12	      =06BC		     brCon   = 06bch	     ;bottom right connor
     13
     14	      =06CD		     horiz   = 06cdh	     ;horiz line
     15	      =06BA		     vertic  = 06bah	     ;vertic line
     16
     17	      =7E00		     fill    = 7e00h	     ;filler symbols
     18
     19				     ;=================================================
     20
     21	0000			     .code
     22				     locals @@
     23				     org 100h
     24
     25				     ;=================================================
     26				     ; Draws a horizontal line
     27				     ; Entry:DI	- address of start
     28				     ;	     CX	- lenght
     29				     ;	     AX	- symb and clr of middle characters
     30				     ;	     BX	- symb and clr of the right character
     31				     ;	     DX	- synb and clr of the left character
     32				     ; Destr:ES, DI, CX
     33				     ;=================================================
     34
     35				     public  horline
     36
     37	0100			     horline proc
     38
     39	0100  68 B800				     push    0b800h
     40	0103  07				     pop     es
     41	0104  26: 89 1D				     mov     word ptr es:[di], BX
     42	0107  83 C7 02				     add     di, 2
     43	010A  F3> AB					     rep     stosw
     44	010C  26: 89 15				     mov     word ptr es:[di], DX
     45	010F  83 C7 02				     add     di, 2
     46
     47	0112  C3				     ret
     48
     49	0113			     horline endp
     50
     51				     ;=================================================
     52				     ; Draws a shadow for the frame
     53				     ; Entry:DI	- left connor of the frame address
     54				     ;	     CX	- width	of the frame
     55				     ;	     DX	- height of the	frame
     56				     ; Destr: AX, BX, SI, ES
     57				     ;=================================================
Turbo Assembler	 Version 4.1	    03/15/20 12:29:57	    Page 2
framesou.asm



     58
     59				     public  frshad
     60
     61	0113			     frshad  proc
     62
     63	0113  57 51 52				     push    di	cx dx
     64
     65	0116  B8 05DF				     mov     ax, bShadow
     66	0119  BB 05DF				     mov     bx, bShadow
     67	011C  8B F2				     mov     si, dx
     68	011E  BA 05DF				     mov     dx, bShadow
     69
     70	0121  83 C7 02				     add     di, 2
     71	0124  E8 FFD9				     call    horline
     72	0127  81 EF 00A2			     sub     di, 162d
     73	012B  B8 05DB				     mov     ax, rShadow
     74	012E  46				     inc     si
     75
     76	012F  AB		     @@rightSh:	     stosw
     77	0130  81 EF 00A2			     sub     di, 162d
     78	0134  4E				     dec     si
     79	0135  83 FE 01				     cmp     si, 1
     80	0138  73 F5				     jae     @@rightSh
     81
     82	013A  5A 59 5F				     pop     dx	cx di
     83
     84	013D  C3				     ret
     85	013E			     frshad  endp
     86
     87				     ;=================================================
     88				     ; Draws a frame
     89				     ; Entry:DI	- left connor address
     90				     ;	     CX	- width
     91				     ;	     DX	- height
     92				     ; Destr: AX, BX, SI, ES
     93				     ;=================================================
     94
     95				     public  framedr
     96
     97	013E			     framedr proc
     98
     99	013E  57				     push    di
    100	013F  51				     push    cx
    101	0140  52				     push    dx
    102
    103	0141  8B F2				     mov     si, dx
    104	0143  51				     push    cx
    105
    106	0144  B8 06CD				     mov     ax, horiz
    107	0147  BB 06C9				     mov     bx, tlCon
    108	014A  BA 06BB				     mov     dx, trCon
    109	014D  E8 FFB0				     call    horline
    110	0150  59				     pop     cx
    111	0151  D1 E1				     shl     cx, 1
    112	0153  2B F9				     sub     di, cx
    113	0155  D1 E9				     shr     cx, 1
    114	0157  81 C7 009C			     add     di, 156d
Turbo Assembler	 Version 4.1	    03/15/20 12:29:57	    Page 3
framesou.asm



    115
    116	015B  56				     push    si
    117
    118	015C  B8 7E00				     mov     ax, fill
    119	015F  BB 06BA				     mov     bx, vertic
    120	0162  BA 06BA				     mov     dx, vertic
    121	0165  51		     @@MID:	     push    cx
    122	0166  E8 FF97				     call    horline
    123	0169  59				     pop     cx
    124	016A  D1 E1				     shl     cx, 1
    125	016C  2B F9				     sub     di, cx
    126	016E  81 C7 009C			     add     di, 156d
    127	0172  D1 E9				     shr     cx, 1
    128	0174  4E				     dec     si
    129	0175  83 FE 00				     cmp     si, 0
    130	0178  77 EB				     ja	     @@MID
    131
    132	017A  5E				     pop     si
    133
    134	017B  B8 06CD				     mov     ax, horiz
    135	017E  BB 06C8				     mov     bx, blCon
    136	0181  BA 06BC				     mov     dx, brCon
    137	0184  51				     push    cx
    138	0185  E8 FF78				     call    horline
    139	0188  59				     pop     cx
    140	0189  D1 E1				     shl     cx, 1
    141	018B  2B F9				     sub     di, cx
    142	018D  D1 E9				     shr     cx, 1
    143	018F  8B D6				     mov     dx, si
    144	0191  81 C7 009C			     add     di, 156d
    145	0195  E8 FF7B				     call    frshad
    146
    147	0198  5A				     pop     dx
    148	0199  59				     pop     cx
    149	019A  5F				     pop     di
    150
    151	019B  C3				     ret
    152
    153	019C			     framedr endp
    154
    155				     ;=================================================
    156				     ; Draws an	extending frame
    157				     ; Destr: AX, BX, CX, DX, ES, SI, DI
    158				     ;=================================================
    159
    160				     public frext
    161
    162	019C			     frext   proc
    163
    164	019C  BF 0722				     mov     di, (80*11+33)*2
    165	019F  B9 000C				     mov     cx, 12
    166	01A2  BA 0001				     mov     dx, 1
    167
    168	01A5  81 EF 00A6	     @@DRAW:	     sub     di, (80+3)*2
    169	01A9  83 C1 06				     add     cx, 6
    170	01AC  83 C2 02				     add     dx, 2
    171	01AF  E8 FF8C				     call    framedr
Turbo Assembler	 Version 4.1	    03/15/20 12:29:57	    Page 4
framesou.asm



    172	01B2  B4 86				     mov     ah, 86h
    173	01B4  51				     push    cx
    174	01B5  52				     push    dx
    175	01B6  B9 0003				     mov     cx, 3
    176	01B9  BA 0D40				     mov     dx, 0d40h
    177	01BC  CD 15				     int     15h
    178	01BE  5A				     pop     dx
    179	01BF  59				     pop     cx
    180	01C0  81 FF 00A0			     cmp     di, 160
    181	01C4  73 DF				     jae     @@DRAW
    182
    183	01C6  C3				     ret
    184
    185	01C7			     frext   endp
    186
    187				     ;=================================================
    188				     ; Print Line in video memory
    189				     ; Entry:SI	offset of line
    190				     ;	     DI	address	in video memory
    191				     ; Destr:AL, DI
    192				     ;=================================================
    193
    194				     public printl
    195
    196	01C7			     printl  proc
    197
    198	01C7  68 B800				     push    0b800h
    199	01CA  07				     pop     es
    200
    201	01CB  AC				     lodsb
    202	01CC  AA		     @@NEXT:	     stosb
    203	01CD  47				     inc di
    204	01CE  AC				     lodsb
    205	01CF  3C 00				     cmp     al, 00
    206	01D1  75 F9				     jne     @@NEXT
    207
    208	01D3  C3				     ret
    209
    210	01D4			     printl  endp
    211
    212
    213				     end
Turbo Assembler	 Version 4.1	    03/15/20 12:29:57	    Page 5
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "03/15/20"
??FILENAME			  Text	 "framesou"
??TIME				  Text	 "12:29:57"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@DRAW				  Near	 DGROUP:01A5
@@MID				  Near	 DGROUP:0165
@@NEXT				  Near	 DGROUP:01CC
@@RIGHTSH			  Near	 DGROUP:012F
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0103H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 FRAMESOU
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BLCON				  Number 06C8
BRCON				  Number 06BC
BSHADOW				  Number 05DF
FILL				  Number 7E00
FRAMEDR				  Near	 DGROUP:013E
FREXT				  Near	 DGROUP:019C
FRSHAD				  Near	 DGROUP:0113
HORIZ				  Number 06CD
HORLINE				  Near	 DGROUP:0100
PRINTL				  Near	 DGROUP:01C7
RSHADOW				  Number 05DB
TLCON				  Number 06C9
TRCON				  Number 06BB
VERTIC				  Number 06BA

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  01D4 Word	  Public  CODE
